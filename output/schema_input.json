{
  "feature_name": "Phê duyệt Yêu cầu (Approval Flow)",
  "sections": [
    {
      "name": "Bộ lọc tìm kiếm (Search Filters)",
      "fields": [
        {
          "name": "Tìm kiếm (Keyword)",
          "type": "text",
          "required": false,
          "description": "Tìm theo nội dung, tên tài liệu, mô tả"
        },
        {
          "name": "Vùng (Region)",
          "type": "select",
          "required": false,
          "description": "Chọn nhiều vùng, có tìm kiếm"
        },
        {
          "name": "Khu vực (Area)",
          "type": "select",
          "required": false,
          "description": "Phụ thuộc vào Vùng. Chỉ active khi đã chọn Vùng."
        },
        {
          "name": "Trạng thái (Status)",
          "type": "select",
          "required": false,
          "description": "Chọn nhiều trạng thái"
        },
        {
          "name": "Người yêu cầu (Requester)",
          "type": "select",
          "required": false,
          "description": "Chọn nhiều, có tìm kiếm tên"
        }
      ]
    },
    {
      "name": "Danh sách & Sắp xếp (List & Sort)",
      "fields": [
        {
          "name": "Tiêu chí sắp xếp (Sort By)",
          "type": "radio",
          "options": ["Ngày tạo (Mới -> Cũ)", "Ngày cập nhật"],
          "required": true,
          "description": "Mặc định là Ngày tạo"
        },
        {
          "name": "Danh sách kết quả (Result Grid)",
          "type": "table",
          "required": true,
          "extra_props": {
            "columns": [
              "Nội dung",
              "Trạng thái",
              "Người yêu cầu",
              "Dự án",
              "Vùng-Khu vực",
              "Link Chi tiết"
            ]
          },
          "description": "Hiển thị danh sách yêu cầu phù hợp bộ lọc"
        }
      ]
    },
    {
      "name": "Chi tiết & Phê duyệt (Detail & Action)",
      "fields": [
        {
          "name": "Popup Chi tiết (Detail Popup)",
          "type": "complex_view",
          "required": false,
          "extra_props": {
            "tabs": ["Thông tin chung", "Lịch sử duyệt"],
            "actions": ["Chuyển đến công việc", "Đóng"]
          },
          "description": "Hiển thị full thông tin khi click vào dòng"
        },
        {
          "name": "Hành động (Action)",
          "type": "radio",
          "options": ["Phê duyệt (Approve)", "Từ chối (Reject)"],
          "required": true,
          "description": "Chỉ hiện với Người phê duyệt được gán"
        },
        {
          "name": "Lý do từ chối (Rejection Reason)",
          "type": "textarea",
          "required": true,
          "description": "Bắt buộc khi chọn Từ chối"
        }
      ]
    }
  ],
  "business_rules": [
    {
      "id": "BR-VIEW-01",
      "description": "Quyền xem: Quản lý thấy toàn bộ dự án. Người tạo chỉ thấy của mình. Người duyệt chỉ thấy cái được phân công.",
      "condition": "User Role Check",
      "expected_result": "List filtered by Role correctly"
    },
    {
      "id": "BR-FILTER-02",
      "description": "Khu vực phụ thuộc Vùng: Nếu chưa chọn Vùng, dropdown Khu vực bị disabled hoặc rỗng.",
      "condition": "Vùng == Empty",
      "expected_result": "Khu vực disabled"
    },
    {
      "id": "BR-SORT-01",
      "description": "Sắp xếp mặc định: Khi vào màn hình, tự động sort theo Ngày tạo mới nhất.",
      "condition": "Initial Load",
      "expected_result": "Sorted by CreatedDate DESC"
    },
    {
      "id": "BR-REJECT-01",
      "description": "Từ chối yêu cầu: Khi từ chối, trạng thái chuyển về 'Đang tiến hành' và bắt buộc nhập lý do.",
      "condition": "Action == Reject",
      "expected_result": "Status = 'In Progress', Reason needed"
    },
    {
      "id": "BR-APPROVE-FLOW",
      "description": "Trình tự duyệt đa cấp: Cấp 1 -> Cấp 2. Cấp 2 Disabled nếu Cấp 1 chưa xong.",
      "condition": "Level 1 Status == Pending",
      "expected_result": "Level 2 User sees 'Approve' button Disabled"
    },
    {
      "id": "BR-CONCURRENCY",
      "description": "Đồng thuận nhóm (Any-One): Trong cùng 1 cấp (A, B), chỉ cần A xử lý là xong. B vào sẽ thấy đã xong.",
      "condition": "User A approved Level 1",
      "expected_result": "User B sees Level 1 as Approved"
    },
    {
      "id": "BR-PERMISSION-ACTION",
      "description": "Nút Duyệt/Từ chối chỉ hiện cho người có trách nhiệm. Người khác (PM, Creator) chỉ xem.",
      "condition": "User is NOT Assigned Approver",
      "expected_result": "Buttons Hidden/Disabled"
    }
  ]
}
